{"version":3,"file":"earth-monitor.umd.js","sources":["../node_modules/tslib/tslib.es6.js","../src/utils/event.ts","../src/common/tool.ts","../src/common/enum.ts","../src/hooks/blankScreen.ts","../src/hooks/jsError.ts","../src/utils/index.ts","../src/hooks/page.ts","../src/hooks/fetch.ts","../src/hooks/xml.ts","../src/hooks/sourceError.ts","../src/hooks/windowListener.ts","../src/index.ts","../src/hooks/index.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","/**\r\n * 事件处理\r\n */\r\nexport class EventModule {\r\n  protected _evt = {};\r\n\r\n  // 订阅者-监听事件的触发\r\n  $on(type, fn) {\r\n    this._evt[type] = this._evt[type] || [];\r\n    this._evt[type].push(fn);\r\n  }\r\n\r\n  // 发布者-触发事件\r\n  $emit(type, ...args) {\r\n    const handlers = this._evt[type] || [];\r\n    if (handlers.length) {\r\n      handlers.forEach((handler) => {\r\n        handler.apply(null, args);\r\n      })\r\n    }\r\n  }\r\n\r\n  // 关闭某个事件监听\r\n  $off(type, fn) {\r\n    const handlers = this._evt[type] || [];\r\n    if (fn) {\r\n      const idx = handlers.findIndex(fn);\r\n      handlers.splice(idx, 1);\r\n    } else {\r\n      this._evt[type] = [];\r\n    }\r\n  }\r\n\r\n  // 全部移除\r\n  $remove() {\r\n    this._evt = {};\r\n  }\r\n}\r\n","// 检查数据类型\r\nexport const CheckType = {\r\n  getTypeString(val: any) {\r\n    return Object.prototype.toString.call(val).toLowerCase()\r\n  },\r\n  isString(val: any) {\r\n    return this.getTypeString(val) === '[object string]'\r\n  },\r\n  isJsonString(val: any) {\r\n    try {\r\n      return typeof JSON.parse(val) === 'object'\r\n    } catch (e) {\r\n      return false\r\n    }\r\n  },\r\n  isNumber(val: any) {\r\n    return this.getTypeString(val) === '[object number]'\r\n  },\r\n  isBoolean(val: any) {\r\n    return this.getTypeString(val) === '[object boolean]'\r\n  },\r\n  isArray(val: any) {\r\n    return this.getTypeString(val) === '[object array]'\r\n  },\r\n  isNull(val: any) {\r\n    return this.getTypeString(val) === '[object null]'\r\n  },\r\n  isUndefined(val: any) {\r\n    return this.getTypeString(val) === '[object undefined]'\r\n  },\r\n  isFunction(val: any) {\r\n    const type = this.getTypeString(val);\r\n    return (type === '[object function]' || type === '[object asyncfunction]'\r\n      || type === '[object promise]')\r\n  },\r\n  isObject(val: any) {\r\n    return this.getTypeString(val) === '[object object]'\r\n  },\r\n  isError(val: any) {\r\n    const type = this.getTypeString(val);\r\n    return (type === '[object error]' || type === '[object errorevent]');\r\n  },\r\n  isRegexp(val) {\r\n    return this.getTypeString(val) === '[object regexp]'\r\n  }\r\n}\r\n\r\nconst ua = navigator.userAgent.toLowerCase();\r\n\r\nexport const getBrowser = () => {\r\n  const browsers = [\r\n    {\r\n      reg: /edge\\/([\\d.]+)/,\r\n      name: 'Edge'\r\n    },\r\n    {\r\n      reg: /rv:([\\d.]+)\\) like gecko/,\r\n      name: 'IE'\r\n    },\r\n    {\r\n      reg: /msie ([\\d.]+)/,\r\n      name: 'IE'\r\n    },\r\n    {\r\n      reg: /firefox\\/([\\d.]+)/,\r\n      name: 'Firefox'\r\n    },\r\n    {\r\n      reg: /chrome\\/([\\d.]+)/,\r\n      name: 'Chrome'\r\n    },\r\n    {\r\n      reg: /opera.([\\d.]+)/,\r\n      name: 'Opera'\r\n    },\r\n    {\r\n      reg: /version\\/([\\d.]+).*safari/,\r\n      name: 'Safari'\r\n    },\r\n    {\r\n      reg: /AppleWebKit\\/([\\d.]+).*mobile.*/i,\r\n      name: 'webkit'\r\n    }\r\n  ]\r\n\r\n  try {\r\n    for (let {reg, name} of browsers) {\r\n      const s = ua.match(reg);\r\n      if (s && s[1]) {\r\n        return `${name} ${s[1]}`\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n  return `unknow`;\r\n}\r\n\r\n// 判断浏览器类型\r\nexport function judgeBrand() {\r\n  const brands = [\r\n    {\r\n      name: 'iPhone',\r\n      reg: /iphone/i\r\n    },\r\n    {\r\n      name: '华为',\r\n      reg: /huawei/i\r\n    },\r\n    {\r\n      name: '荣耀',\r\n      reg: /honor/i\r\n    },\r\n    {\r\n      name: 'Oppo',\r\n      reg: [/oppo/i, /pacm00/i]\r\n    },\r\n    {\r\n      name: 'Vivo',\r\n      reg: /vivo/i\r\n    },\r\n    {\r\n      name: '小米',\r\n      reg: [/mi\\s/i, /mix\\s/i, /redmi/i]\r\n    },\r\n    {\r\n      name: '三星',\r\n      reg: /sm-/i\r\n    }\r\n  ]\r\n  try {\r\n    for (let {reg, name} of brands) {\r\n      if (reg instanceof Array) {\r\n        for (let i of reg) {\r\n          if (i.test(ua)) {\r\n            return name;\r\n          }\r\n        }\r\n      } else {\r\n        if (reg.test(ua)) {\r\n          return name;\r\n        }\r\n      }\r\n    }\r\n  } catch (e) {\r\n    return '';\r\n  }\r\n  return '';\r\n}\r\n\r\n\r\n// header信息转为json对象\r\nexport function headerToJson(headers) {\r\n  const arr = headers.trim().split(/[\\r\\n]+/);\r\n  const json: any = {};\r\n  arr.forEach((item) => {\r\n    const keyVal = item.split(': ');\r\n    keyVal.length && (json[keyVal[0]] = keyVal[1]);\r\n  })\r\n  return json;\r\n}","// 上报类型\r\nexport const enum REPORT_TYPE {\r\n  openPage = 'openPage', // 页面启动\r\n  pageView = 'pageView',\r\n  jsError = 'jsError',\r\n  apiRequest = 'apiRequest',\r\n  sourceError = 'sourceError',\r\n  blankScreen = 'blankScreen',\r\n  performance = 'performance',\r\n  selfReport = 'selfReport'\r\n}\r\n\r\nexport const WINDOW_ONLOAD = 'load';\r\nexport const WINDOW_UNLOAD = 'unload';\r\nexport const WINDOW_ERROR = 'windowError';\r\nexport const HASH_CHANGE = 'hashchange';\r\nexport const HISTORY_STATE_CHANGE = 'historyStatechange';\r\nexport const POP_STATE = 'popstate';\r\nexport const PROMISE_ERROR = 'promiseError';\r\nexport const SUCCESS_CODE = [200]\r\n\r\nexport const H5_LOAD_END = 'h5LoadEnd';\r\n\r\n// 探针类型\r\nexport const enum PLUGINS {\r\n  OPEN_PAGE = 'openPage',\r\n  PAGE_VIEW = 'pageView',\r\n  JS_ERROR = 'jsError',\r\n  API_REQUEST = 'apiRequest',\r\n  SOURCE_ERROR = 'sourceError',\r\n  BLANK_PAGE = 'blankScreen',\r\n  PERFORMANCE = 'performance'\r\n}\r\n","import { REPORT_TYPE, WINDOW_ONLOAD } from \"../common/enum\"\r\n\r\n/**\r\n * 白屏异常监控逻辑处理\r\n */\r\nexport default (ctx) => {\r\n\r\n  let __flag = false;\r\n\r\n  /**\r\n   * 判断页面是否白屏\r\n   * @param dom dom对象\r\n   * @param num 次数\r\n   * @returns 无\r\n   */\r\n function isWhite(dom: any, num: number) {\r\n  if (!dom) return false;\r\n\r\n  const blackTags = ['head', 'meta', 'script', 'style', 'title'];\r\n\r\n  const children = ([].slice.call(dom.children || [])).filter((node: HTMLElement) => {\r\n    return blackTags.indexOf(node.tagName.toLowerCase()) < 0;\r\n  })\r\n\r\n  for (let i = 0; i < children.length; i++) {\r\n    const node: HTMLElement = children[i];\r\n    const {width, height} = node.getBoundingClientRect();\r\n\r\n    const isVisible = (width > 0 && height > 0);\r\n    num = isVisible ? num + 1 : num;\r\n\r\n    if (num > 0) {\r\n      return __flag = true;\r\n    }\r\n    /**\r\n     * nodeType\r\n     * 1: 元素节点  Node.ELEMENT_NODE\r\n     * 2：元素的属性 Node.ATTRIBUTE_NODE\r\n     * 3：元素或属性中实际的文本 Node.TEXT_NODE\r\n     * 8：一个注释节点 Node.COMMENT_NODE\r\n     * 9： 一个document节点  Node.DOCUMENT_NODE\r\n     */\r\n    if (node.nodeType === 1 && blackTags.indexOf(node.tagName.toLowerCase()) < 0) {\r\n      isWhite(node, num);\r\n    }\r\n  }\r\n  return __flag;\r\n }\r\n\r\n  ctx.$on(WINDOW_ONLOAD, () => {\r\n    const {domId, whiteTime} = ctx.options;\r\n    \r\n    setTimeout(() => {\r\n      // querySelector返回选择器匹配的第一个元素\r\n      const dom = document.querySelector(`#${domId}`) || document.querySelector(`.${domId}`);\r\n\r\n      if (!isWhite(dom, 0)) {\r\n        ctx.report({\r\n          type: REPORT_TYPE.blankScreen\r\n        })\r\n      }\r\n    }, whiteTime * 1000)\r\n  })\r\n}","import { PROMISE_ERROR, WINDOW_ERROR, WINDOW_ONLOAD } from \"../common/enum\"\r\nimport { CheckType } from \"../common/tool\";\r\n\r\n// TODO: 增加try catch error监听\r\nexport default (ctx) => {\r\n  const errHandler = (err) => {\r\n    // 过滤掉资源异常\r\n    const tagName = (err.target || {}).tagName; \r\n    if (!tagName) {\r\n      ctx.reportError(err);\r\n    }\r\n  }\r\n\r\n  const promiseErrorHandler = (err) => {\r\n    if (CheckType.isError(err.reason)) {\r\n      ctx.reportError(err.reason);\r\n    }\r\n  }\r\n\r\n  ctx.$on(WINDOW_ERROR, errHandler);\r\n  ctx.$on(PROMISE_ERROR, promiseErrorHandler);\r\n\r\n  ctx.$on(WINDOW_ONLOAD, () => {\r\n     // @ts-ignore\r\n    if (window.Vue) {\r\n      ctx.captureVueError();\r\n    }\r\n  })\r\n}","import { CheckType } from \"../common/tool\";\r\n\r\n/**\r\n * 判断异常信息是否在异常白名单中，如果在不上报\r\n * @param scriptErrorWhite 异常白名单\r\n * @param errorMessage 异常信息\r\n * @returns 是否在异常白名单中\r\n */\r\nexport const judeScriptErrorWhite = (scriptErrorWhite: Array<string | RegExp>, errorMessage: string) => {\r\n  let ignore = false;\r\n  try {\r\n    if (!errorMessage) {\r\n      ignore = true;\r\n    }\r\n    if (CheckType.isArray(scriptErrorWhite) && scriptErrorWhite.length && errorMessage) {\r\n      ignore = scriptErrorWhite.some((item) => {\r\n        if (CheckType.isString(item)) {\r\n          const lowerItem = (item as String).toLowerCase();\r\n          const lowerErrMsg = errorMessage.toLowerCase();\r\n          return lowerErrMsg.indexOf(lowerItem) > -1;\r\n        } else if (CheckType.isRegexp(item)) {\r\n          return (item as RegExp).test(errorMessage);\r\n        }\r\n      });\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n  return ignore;\r\n}\r\n\r\n// 生成时间戳\r\nexport const timeStamp = () => {\r\n  return  new Date().getTime();\r\n}","import { HASH_CHANGE, HISTORY_STATE_CHANGE, POP_STATE, REPORT_TYPE, WINDOW_ONLOAD } from \"../common/enum\";\r\nimport { getBrowser } from \"../common/tool\";\r\nimport { timeStamp } from \"../utils\";\r\n\r\nexport const openPage = (ctx) => {\r\n  // @ts-ignore line\r\n  const perform = window.performance || window.webkitPerformance || window.msPerformance || window.mozPerformance\r\n  const timing = (perform.timing || {})\r\n  const openPageHandler = async () => {\r\n    const {client, ua, system, device} = ctx.options;\r\n    const data = {\r\n      type: REPORT_TYPE.openPage,\r\n      client,\r\n      ua,\r\n      system,\r\n      device,\r\n      occurTime: timing.fetchStart || timeStamp()\r\n    };\r\n    await ctx.report(data);\r\n  };\r\n  openPageHandler();\r\n}\r\n\r\nconst __interceptor = (eventType: string) => {\r\n  const originEvent = history[eventType];\r\n\r\n  // 重写history上的方法\r\n  history[eventType] = function () {\r\n    const args = [].slice.call(arguments);\r\n    // CustomEvent 由应用程序为任何目的初始化的事件。自定义事件对象\r\n    const event = new CustomEvent(HISTORY_STATE_CHANGE);\r\n    const origin = originEvent.apply(this, args);\r\n    // 触发自定义事件historyStatechange\r\n    // 通过手动使用 dispatchEvent() 方法派发的事件\r\n    window.dispatchEvent(event);\r\n    return origin;\r\n  }\r\n}\r\nconst __stateInterceptor = () => {\r\n  __interceptor('pushState');\r\n  __interceptor('replaceState');\r\n}\r\n\r\n/**\r\n * history.pushState() 按指定的名称和 URL（如果提供该参数）将数据 push 进会话历史栈\r\n * history.replaceState() 按指定的数据、名称和 URL（如果提供该参数），更新 history 栈上最新的条目\r\n * \r\n */\r\nexport const pageView =  (ctx) => {\r\n  const {spa = true} = ctx.options;\r\n  const browser = getBrowser().toLowerCase();\r\n  const routerMode = !!window.history.pushState ? 'history' : 'hash';\r\n  \r\n  ctx.$on(WINDOW_ONLOAD, () => {\r\n    if (!((browser === 'chrome' || browser === 'safari') && routerMode === 'history')) {\r\n      // chrome, safari 浏览器中popstate首次进入就会触发\r\n      ctx.report({\r\n        type: REPORT_TYPE.pageView\r\n      });\r\n    }\r\n  })\r\n\r\n  if (spa) {\r\n    if (routerMode === 'hash') {\r\n      ctx.$on(HASH_CHANGE, () => {\r\n        ctx.report({\r\n          type: REPORT_TYPE.pageView\r\n        });\r\n      });\r\n    }\r\n\r\n    if (routerMode === 'history') {\r\n      ctx.$on(POP_STATE, () => {\r\n        ctx.report({\r\n          type: REPORT_TYPE.pageView\r\n        });\r\n      });\r\n    }\r\n\r\n    __stateInterceptor();\r\n\r\n    // pushState, replaceState触发事件\r\n    ctx.$on(HISTORY_STATE_CHANGE, () => {\r\n      ctx.report({\r\n        type: REPORT_TYPE.pageView\r\n      });\r\n    });\r\n  }\r\n}","import { REPORT_TYPE } from \"../common/enum\";\r\nimport { timeStamp } from \"../utils\";\r\n\r\nconst fetchInterceptor = (ctx) => {\r\n  const _fetch = window.fetch;\r\n\r\n  // 重写window上的fetch方法\r\n  // @ts-ignore\r\n  window.fetch = function () {\r\n    // 将arguments对象转换为一个真正的数组\r\n    // const args = [].slice.call(arguments);\r\n    const args: any = Array.from(arguments);\r\n    const urlList = args && args[0] && (args[0].split('?')) || [];\r\n\r\n    const startTime = timeStamp();\r\n    let data: any = {\r\n      requestUrl: urlList[0] || '',\r\n      requestUrlParams: urlList[1] || '',\r\n      requestType: ((args[1] || {}).method || 'get').toUpperCase()\r\n    };\r\n\r\n    return _fetch.apply(this, args).then((res) => {\r\n      try {\r\n        if (res) {\r\n          // 创建一个 Response 对象的克隆。\r\n          const copy = res.clone();\r\n          const status = +copy.status; // 转数字\r\n          copy.text().then((ts) => {\r\n            // 文本对象\r\n\r\n            data = {\r\n              ...data,\r\n              duration: timeStamp() - startTime,\r\n              requestId: copy.headers.get('requestid') || '',\r\n              requestCode: copy.status,\r\n              type: REPORT_TYPE.apiRequest\r\n            }\r\n            if (!data.requestUrl) return;\r\n            // 上报\r\n            ctx.report(data);\r\n          })\r\n        }\r\n      } catch(e) {\r\n        ctx.reportError(e);\r\n      }\r\n    }).catch((e) => {\r\n      ctx.reportError(e);\r\n    });\r\n  }\r\n}\r\n\r\nexport default (ctx) => {\r\n  if (typeof window !== 'undefined') {\r\n    fetchInterceptor(ctx);\r\n  }\r\n}","import { REPORT_TYPE } from \"../common/enum\";\r\nimport { headerToJson } from \"../common/tool\";\r\nimport { timeStamp } from \"../utils\";\r\n\r\nconst xmlInterceptor = (ctx) => {\r\n  const xml: any = window.XMLHttpRequest.prototype; // 原型对象\r\n  /**\r\n   * 改写XMLHttpRequest原型对象上的三个方法\r\n   * open\r\n   * setRequestHeader\r\n   * send\r\n   */\r\n\r\n  // 先保存原来的三个方法\r\n  const originOpen = xml.open;\r\n  const originSetRequestHeader = xml.setRequestHeader;\r\n  const originSend = xml.send;\r\n\r\n  xml.open = function(method, url) {\r\n    this.__reqData__ = {\r\n      method,\r\n      url: url || '',\r\n      start: timeStamp(),\r\n      headers: {}\r\n    }\r\n    const args: any = Array.from(arguments);\r\n    originOpen.apply(this, args);\r\n  }\r\n\r\n  xml.setRequestHeader = function (header, value) {\r\n    this.__reqData__ && (this.__reqData__.headers[header] = value);\r\n    const args: any = Array.from(arguments);\r\n    originSetRequestHeader.apply(this, args);\r\n  }\r\n\r\n  xml.send = function() {\r\n    let onReadyStateChange = this.onreadystatechange || function () {};\r\n\r\n    this.onreadystatechange = function() {\r\n      const args = Array.from(arguments);\r\n      onReadyStateChange.apply(this, args);\r\n\r\n      if (this.readyState === 4 && this.__reqData__) {\r\n        try {\r\n          const responseHeaders = headerToJson(this.getAllResponseHeaders()) || {};\r\n          const urlArr = this.__reqData__.url.split('?') || [];\r\n\r\n          const data = {\r\n            requestId: responseHeaders.requestid || '',\r\n            duration: timeStamp() - this.__reqData__.startTime,\r\n            requestUrl: urlArr[0] || '',\r\n            requestUrlParams: urlArr[1] || '',\r\n            requestType: this.__reqData__.method.toUpperCase(),\r\n            requestCode: this.status,\r\n            type: REPORT_TYPE.apiRequest\r\n          };\r\n\r\n          if (!data.requestUrl) return;\r\n          ctx.report(data);\r\n        } catch (e) {\r\n          ctx.reportError(e);\r\n        }\r\n      }\r\n    }\r\n\r\n    const args: any = Array.from(arguments);\r\n    originSend.apply(this, args);\r\n  }\r\n};\r\nexport default (ctx) => {\r\n  if (typeof window !== 'undefined') {\r\n    xmlInterceptor(ctx);\r\n  }\r\n}","import { WINDOW_ERROR } from \"../common/enum\";\r\n\r\n// 必须保证每个功能的独立性\r\nexport default (ctx) => {\r\n  const sourceErrHandler = (err) => {\r\n    const tagName = (err.target || {}).tagName; \r\n    if (tagName) {\r\n      ctx.reportError(err);\r\n    }\r\n  }\r\n  ctx.$on(WINDOW_ERROR, sourceErrHandler);\r\n}\r\n","import { HASH_CHANGE, HISTORY_STATE_CHANGE, POP_STATE, PROMISE_ERROR, WINDOW_ERROR, WINDOW_ONLOAD } from \"../common/enum\"\r\n\r\nexport default (ctx) => {\r\n  const loadEmit = (e) => {\r\n    ctx.$emit(WINDOW_ONLOAD, e);\r\n  };\r\n\r\n  const errorEmit = (e) => {\r\n    ctx.$emit(WINDOW_ERROR)\r\n  }\r\n\r\n  const promiseErrorEmit = (e) => {\r\n    ctx.$emit(PROMISE_ERROR)\r\n  }\r\n\r\n  const hashChangeEmit = () => {\r\n    ctx.$emit(HASH_CHANGE);\r\n  }\r\n\r\n  const popChangeEmit = () => {\r\n    ctx.$emit(POP_STATE);\r\n  }\r\n\r\n  const historyStateChangeEmit = () => {\r\n    ctx.$emit(HISTORY_STATE_CHANGE);\r\n  }\r\n\r\n  const unloadEmit = () => {\r\n    window.removeEventListener('load', loadEmit);\r\n    window.removeEventListener('error', errorEmit, true);\r\n    window.removeEventListener('unhandledrejection', promiseErrorEmit);\r\n    window.removeEventListener('hashchange', hashChangeEmit);\r\n    window.removeEventListener('popstate', popChangeEmit);\r\n    window.removeEventListener('historyStatechange', historyStateChangeEmit);\r\n\r\n    ctx.$remove();\r\n    ctx.uninstall();\r\n  }\r\n\r\n  window.addEventListener('load', loadEmit);\r\n  window.addEventListener('error', errorEmit, true);\r\n  window.addEventListener('unhandledrejection', promiseErrorEmit);\r\n  window.addEventListener('hashchange', hashChangeEmit);\r\n  window.addEventListener('popstate', popChangeEmit);\r\n  window.addEventListener('historyStatechange', historyStateChangeEmit); // 自定义的historyState改变监听事件\r\n  window.addEventListener('beforeunload', unloadEmit)\r\n}","import { EventModule } from \"./utils/event\";\r\nimport initHooks from './hooks'\r\nimport { PLUGINS, REPORT_TYPE } from \"./common/enum\";\r\nimport { CheckType } from \"./common/tool\";\r\nimport { judeScriptErrorWhite } from \"./utils\";\r\n\r\ntype Func = (ctx?) => (Promise<any> | void);\r\n\r\ninterface Options {\r\n  projectId: (() => string) | string; // 项目的唯一标识\r\n  userId: (() => string) | string; // 用户的唯一标识\r\n  domId?: string; // 判断白屏的核心dom \r\n  whiteTime?: number; // 白屏时间\r\n  scriptErrorWhite?: Array<string | RegExp>; // js异常白名单\r\n  beforeStart?: Func;\r\n  beforeReport?: Func;\r\n  [propsName: string]: any;\r\n}\r\n\r\nconst processHooks = (hooks, ctx) => {\r\n  return Promise.all(hooks.map((hook) => hook.call(null, ctx)))\r\n}\r\n\r\n/**\r\n * EarthMonitor处理监控\r\n */\r\nclass EarthMonitor extends EventModule{\r\n  options: Options;\r\n  startHooks = Array<Func>;\r\n  beforeStart: Func | undefined;\r\n  beforeReport: Func | undefined;\r\n\r\n  _isCaptured: boolean;\r\n  _isReady: boolean;\r\n\r\n  constructor(options) {\r\n    super();\r\n    this.options = options;\r\n    this.beforeStart = options?.beforeStart;\r\n    this.beforeReport = options?.beforeReport;\r\n\r\n    this._isReady = false;\r\n    this._isCaptured = false;\r\n  }\r\n\r\n  /**\r\n   * 开始执行\r\n   * 1、判断项目唯一标识是否传入\r\n   * 2、执行beforStart\r\n   * 3、初始化hooks\r\n   * 4、执行hooks\r\n   */\r\n  async start() {\r\n    try {\r\n      if (!this.options?.projectId) {\r\n        console.error('项目唯一标识未传！');\r\n        return;\r\n      }\r\n\r\n      if (this.beforeStart) {\r\n        const res = await this.beforeStart(this);\r\n        if (typeof res === 'boolean' && !res) return;\r\n      }\r\n\r\n      // 初始化hooks\r\n      initHooks(this);\r\n      if (this.startHooks) {\r\n        await processHooks(this.startHooks, this)\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 上报数据\r\n   * @param data 上报数据\r\n   * @returns 无\r\n   */\r\n  report (data) {\r\n    try {\r\n      if (!this._isReady) {\r\n        console.warn('项目未调用install方法，请先调用', data);\r\n        return;\r\n      }\r\n      const options = {\r\n        ...(CheckType.isObject(data) ? data : {})\r\n      }\r\n      // 这里请求\r\n\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 上报异常\r\n   * 1、根据targetName分类，执行异常还是资源异常\r\n   * 2、资源异常上报type： sourceError\r\n   * 3、执行异常上报type: jsError\r\n   * @param err Error对象\r\n   * @param options 参数\r\n   * @returns 无\r\n   */\r\n  async reportError(err, options?) {\r\n    if (CheckType.isString(err) || CheckType.isNumber(err)) return;\r\n\r\n    const target = err.target || {};\r\n    if (options && !CheckType.isObject(options)) {\r\n      options = {};\r\n    }\r\n\r\n    // 资源加载异常\r\n    if (target.tagName) {\r\n      const url = target.src || target.url || target.link || target.href;\r\n      const data = {\r\n        requestUrl: url && url.split('?')[0],\r\n        resourceType: target.tagName.toLowerCase()\r\n      };\r\n\r\n      await this.report({...data, type: REPORT_TYPE.sourceError});\r\n    } else {\r\n      // js执行错误\r\n\r\n      if (err.name === 'APIError') {\r\n        return;\r\n      }\r\n\r\n      const isIgnore = judeScriptErrorWhite(this.options.scriptErrorWhite || [], err.message);\r\n\r\n      if (err.message && !isIgnore) {\r\n        const data = {\r\n          errorMessage: err.message,\r\n          errorStack: err.stack\r\n        };\r\n        await this.report({...data, type: REPORT_TYPE.jsError, ...options});\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 捕获vue异常\r\n   * @param Vue vue\r\n   */\r\n  captureVueError(Vue?) {\r\n    // @ts-ignore\r\n    Vue = Vue || window.Vue\r\n    const _this = this;\r\n    // VUE3中错误捕获调用的是createApp(App).config.errorHandler\r\n    if (Vue && !this._isCaptured && Vue.config) {\r\n      const handler = Vue.config.errorHandler;\r\n      Vue.config.errorHandler = function (err) {\r\n        console.error(err);\r\n        _this.reportError(err);\r\n        handler && handler.apply(this, [].slice.call(arguments));\r\n      }\r\n      this._isCaptured = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 安装探针\r\n   * @param plugins 探针列表\r\n   */\r\n  install (plugins) {\r\n    this.options.plugins = plugins;\r\n    this.start().catch(e => {\r\n      console.log(e);\r\n    })\r\n  }\r\n\r\n  \r\n  // 安装全部探针\r\n  installAll() {\r\n    const plugins = [\r\n      PLUGINS.API_REQUEST,\r\n      PLUGINS.JS_ERROR,\r\n      PLUGINS.OPEN_PAGE,\r\n      PLUGINS.PAGE_VIEW,\r\n      PLUGINS.PERFORMANCE,\r\n      PLUGINS.SOURCE_ERROR,\r\n      PLUGINS.BLANK_PAGE\r\n    ];\r\n    this.install(plugins);\r\n  }\r\n\r\n  // 卸载探针\r\n  uninstall() {\r\n    this.options.plugins = [];\r\n    this._isReady = false;\r\n  }\r\n}\r\n\r\nexport default EarthMonitor;","import { PLUGINS } from \"../common/enum\";\r\nimport { CheckType } from \"../common/tool\";\r\nimport blankScreen from \"./blankScreen\";\r\nimport jsError from \"./jsError\";\r\nimport { openPage, pageView } from \"./page\";\r\nimport fetchRequest from './fetch';\r\nimport xml from \"./xml\";\r\nimport sourceError from \"./sourceError\";\r\nimport windowListener from \"./windowListener\";\r\n\r\nexport default function initHooks(ctx) {\r\n  const {plugins = []} = ctx.options;\r\n  if (!plugins.length) return;\r\n\r\n  ctx.startHooks.push(windowListener);\r\n\r\n  const handlerMap = {\r\n    [PLUGINS.OPEN_PAGE]: openPage,\r\n    [PLUGINS.PAGE_VIEW]: pageView,\r\n    [PLUGINS.BLANK_PAGE]: blankScreen,\r\n    [PLUGINS.SOURCE_ERROR]: sourceError,\r\n    [PLUGINS.API_REQUEST]:  [fetchRequest, xml],\r\n    [PLUGINS.JS_ERROR]: jsError,\r\n    [PLUGINS.PERFORMANCE]: performance\r\n  }\r\n\r\n  plugins.forEach((plugin) => {\r\n    const handler = handlerMap[plugin];\r\n    if (CheckType.isArray(handler)) {\r\n      ctx.startHooks = ctx.startHooks.concat(handler);\r\n    } else {\r\n      ctx.startHooks.push(handler);\r\n    }\r\n  })\r\n}"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__assign","assign","t","s","i","n","arguments","length","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","_","label","sent","trys","ops","g","create","Iterator","verb","Symbol","iterator","v","op","TypeError","pop","push","SuppressedError","EventModule","_evt","$on","type","fn","$emit","args","_i","handlers","forEach","handler","$off","idx","findIndex","splice","$remove","CheckType","getTypeString","val","toString","toLowerCase","isString","isJsonString","JSON","parse","isNumber","isBoolean","isArray","isNull","isUndefined","isFunction","isObject","isError","isRegexp","ua","navigator","userAgent","WINDOW_ONLOAD","WINDOW_ERROR","HASH_CHANGE","HISTORY_STATE_CHANGE","POP_STATE","PROMISE_ERROR","blankScreen","ctx","__flag","isWhite","dom","num","blackTags","children","slice","filter","node","indexOf","tagName","_a","getBoundingClientRect","width","height","nodeType","options","domId","whiteTime","setTimeout","document","querySelector","report","jsError","err","target","reportError","reason","window","Vue","captureVueError","timeStamp","Date","getTime","openPage","timing","performance","webkitPerformance","msPerformance","mozPerformance","client","system","device","data","occurTime","fetchStart","_b","__interceptor","eventType","originEvent","history","event","CustomEvent","origin","dispatchEvent","pageView","spa","browser","browsers_1","reg","name","name_1","match","concat","console","log","getBrowser","routerMode","pushState","fetchRequest","_fetch","fetch","from","urlList","split","startTime","requestUrl","requestUrlParams","requestType","method","toUpperCase","res","copy_1","clone","status","text","ts","duration","requestId","headers","get","requestCode","catch","fetchInterceptor","xml","XMLHttpRequest","originOpen","open","originSetRequestHeader","setRequestHeader","originSend","send","url","__reqData__","start","header","onReadyStateChange","onreadystatechange","arr","json","readyState","responseHeaders","getAllResponseHeaders","trim","item","keyVal","urlArr","requestid","xmlInterceptor","sourceError","windowListener","loadEmit","errorEmit","promiseErrorEmit","hashChangeEmit","popChangeEmit","historyStateChangeEmit","addEventListener","removeEventListener","uninstall","EarthMonitor","_super","_this_1","startHooks","beforeStart","beforeReport","_isReady","_isCaptured","String","__","constructor","__extends","projectId","error","plugins","handlerMap","plugin","initHooks","hooks","all","map","hook","e_1","warn","src","link","href","resourceType","isIgnore","scriptErrorWhite","errorMessage","ignore","some","lowerItem","test","judeScriptErrorWhite","message","errorStack","stack","_this","config","handler_1","errorHandler","install","installAll"],"mappings":"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"}